<div class="rounded-lg lg:max-w-5xl w-full mx-auto lg:py-8 py-16" [formGroup]="productFormGroup()">
  <div class="mb-6">
    <label for="title" class="flex justify-between items-center text-sm font-medium text-[#5B616C] mb-2">
      Title
      <img src="images/title-icon.svg" alt="title info icon" />
    </label>
    <div class="flex border border-gray-300 rounded-md shadow-sm bg-white pr-2">
      <input
      id="title"
      type="text"
      formControlName="title"
      data-test-id="product-title-input"
      [class]="productFormGroup().controls['title'].invalid && productFormGroup().controls['title'].touched
        ? 'w-full px-4 py-2 border border-[#FF4530] focus:outline-none focus:ring-0 rounded-md'
        : 'w-full px-4 py-2 outline-none rounded-md placeholder:text-[#9297A0] text-lg'"
      [attr.aria-invalid]="productFormGroup().controls['title'].invalid && productFormGroup().controls['title'].touched ? 'true' : 'false'"
      [attr.aria-describedby]="productFormGroup().controls['title'].invalid && productFormGroup().controls['title'].touched ? 'title-error' : null"
      placeholder="Scenario title" />
      <img src="images/globe-icon.svg" alt="scenario title globe icon" />
    </div>

    @if (productFormGroup().controls['title'].invalid && productFormGroup().controls['title'].touched) {
      <div id="title-error" class="mt-1 text-sm text-red-600" data-test-id="product-title-error" role="alert" aria-live="polite">Title is required</div>
    }
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div>
      <label for="tenant" class="block text-sm font-medium text-[#747884] mb-2">Select Tenant</label>
      <select
        id="tenant"
        formControlName="tenant"
        data-test-id="product-tenant-select"
        [class]="productFormGroup().controls['tenant'].invalid && productFormGroup().controls['tenant'].touched
          ? 'w-full px-3 py-2 border border-[#FF4530] rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-gray-900 text-lg'
          : 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-gray-900 text-lg'"
        [attr.aria-invalid]="productFormGroup().controls['tenant'].invalid && productFormGroup().controls['tenant'].touched ? 'true' : 'false'"
        [attr.aria-describedby]="productFormGroup().controls['tenant'].invalid && productFormGroup().controls['tenant'].touched ? 'tenant-error' : null">
        <option value="">Choose a tenant...</option>
        @for (tenant of tenantOptions; track tenant.id) {
          <option [value]="tenant.id">{{ tenant.name }}</option>
        }
      </select>
      @if (productFormGroup().controls['tenant'].invalid && productFormGroup().controls['tenant'].touched) {
        <div id="tenant-error" class="mt-1 text-sm text-red-600" data-test-id="product-tenant-error" role="alert" aria-live="polite">Please select a tenant</div>
      }
    </div>

    <div>
      <label for="company" class="block text-sm font-medium text-[#747884] mb-2">Select Company</label>
      <select
        id="company"
        formControlName="company"
        data-test-id="product-company-select"
        [class]="productFormGroup().controls['company'].invalid && productFormGroup().controls['company'].touched
          ? 'w-full px-3 py-2 border border-[#FF4530] rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-gray-900 text-lg'
          : 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-gray-900 text-lg'"
        [attr.aria-invalid]="productFormGroup().controls['company'].invalid && productFormGroup().controls['company'].touched ? 'true' : 'false'"
        [attr.aria-describedby]="productFormGroup().controls['company'].invalid && productFormGroup().controls['company'].touched ? 'company-error' : null">
        <option value="">Choose a company...</option>
        @for (company of companyOptions; track company.id) {
          <option [value]="company.id">{{ company.name }}</option>
        }
      </select>
      @if (productFormGroup().controls['company'].invalid && productFormGroup().controls['company'].touched) {
        <div id="company-error" class="mt-1 text-sm text-red-600" role="alert" aria-live="polite">Please select a company</div>
      }
    </div>
  </div>

  <div class="mb-8">
    <label for="experienceProduct" class="block text-sm font-medium text-[#747884] mb-2">Select Employee Experience Product</label>
    <div [class]="productFormGroup().controls['experienceProduct'].invalid && productFormGroup().controls['experienceProduct'].touched
      ? 'flex items-center justify-start border border-[#FF4530] rounded-md shadow-sm bg-white pl-4 pr-0'
      : 'flex items-center justify-start border border-gray-300 rounded-md shadow-sm bg-white pl-4 pr-0'">
      <img src="images/eep-icon.svg" alt="employee happiness label icon" class="h-6 mr-2" />
      <select
      id="experienceProduct"
      formControlName="experienceProduct"
      class="w-full py-2 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-gray-900 text-lg"
      [attr.aria-invalid]="productFormGroup().controls['experienceProduct'].invalid && productFormGroup().controls['experienceProduct'].touched ? 'true' : 'false'"
      [attr.aria-describedby]="productFormGroup().controls['experienceProduct'].invalid && productFormGroup().controls['experienceProduct'].touched ? 'experience-product-error' : null">
      <option value="">Choose a product...</option>
      @for (product of experienceProductOptions; track product.id) {
        <option [value]="product.id">{{ product.name }}</option>
      }
    </select>
    </div>
    @if (productFormGroup().controls['experienceProduct'].invalid && productFormGroup().controls['experienceProduct'].touched) {
      <div id="experience-product-error" class="mt-1 text-sm text-red-600" role="alert" aria-live="polite">Please select an employee experience product</div>
    }
  </div>

  <div class="flex items-center justify-between mb-4 bg-[#F1F2F3] px-4 py-3">
    <h3 class="text-[9.9px] font-semibold text-[#747884] uppercase">SURVEYS LIST</h3>
  </div>

  <div class="bg-white rounded-lg border border-gray-200 overflow-y-scroll">
    <table class="w-full" role="table" aria-label="Survey selection table">
      <thead class="bg-gray-50 border-b border-gray-200">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12">
            <input
              type="checkbox"
              [checked]="areAllCurrentPageSurveysSelected()"
              [indeterminate]="areSomeCurrentPageSurveysSelected()"
              (change)="toggleAllCurrentPageSurveys()"
              class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
              aria-label="Select all surveys on current page">
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NAME</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CREATION DATE</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">START DATE</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">END DATE</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        @for (survey of currentPageSurveys(); track survey.id) {
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-6 py-4 whitespace-nowrap">
              <input
                type="checkbox"
                [checked]="survey.selected"
                (change)="toggleSurvey(survey.id)"
                class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                [attr.aria-label]="'Select survey: ' + survey.name">
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-gray-900">{{ survey.name }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-500">{{ survey.creationDate }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-500">{{ survey.startDate }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-500">{{ survey.endDate }}</div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="flex flex-col lg:flex-row gap-2 items-center justify-between mt-6">
    <div class="text-sm text-gray-700" id="pagination-info" aria-live="polite">
      Showing {{ currentPageStartIndex() }} - {{ currentPageEndIndex() }} of {{ pagination().totalSurveys }} surveys
    </div>
    <nav aria-label="Survey pagination" class="flex gap-1">
      @for (page of paginationPages(); track page) {
        <button
          type="button"
          (click)="goToPage(page)"
          [class]="page === pagination().currentPage
            ? 'bg-primary text-white'
            : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'"
          class="px-3 py-2 text-sm font-medium rounded transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
          [attr.aria-label]="page === pagination().currentPage ? 'Current page, page ' + page : 'Go to page ' + page"
          [attr.aria-current]="page === pagination().currentPage ? 'page' : null">
          {{ page }}
        </button>
      }
    </nav>
    <div class="flex items-center space-x-2">
      <span class="text-sm text-gray-500 mr-3" aria-describedby="pagination-info">Page {{ pagination().currentPage }} of {{ pagination().totalPages }}</span>
    </div>
  </div>
</div>